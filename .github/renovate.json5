{
  $schema: "https://docs.renovatebot.com/renovate-schema.json",

  extends: ["config:best-practices", ":disableDependencyDashboard"],

  labels: ["renovate"],

  customManagers: [
    {
      customType: "regex",
      description: "Comment-based updates for YAML and Justfile",
      managerFilePatterns: [
        "/(^|/)\\.github/(workflows|actions)/.*\\.ya?ml$/",
        "/(^|/)action\\.ya?ml$/",
        "/(^|/)justfile$/",
      ],
      matchStrings: [
        "[:=]\\s*[\"']?(?<currentValue>v?[\\d\\.]+)[\"']?\\s*#\\s*renovate:\\s*datasource=[\"']?(?<datasource>[^\\s\"']+)[\"']?\\s+depName=[\"']?(?<depName>[^\\s\"']+)[\"']?",
      ],
      depNameTemplate: "{{ depName }}",
      datasourceTemplate: "{{ datasource }}",
    },

    {
      customType: "regex",
      description: "Terraform version in GitHub Actions YAML and Dockerfile",
      managerFilePatterns: [
        "/(^|/)\\.github/(workflows|actions)/.*\\.ya?ml$/",
        "/(^|/)Dockerfile$/",
      ],
      matchStrings: [
        "terraform_version:\\s*[\"']?(?<currentValue>[\\d\\.]+)[\"']?",
        "ENV\\s+TERRAFORM_VERSION[=\\s][\"']?(?<currentValue>v?[\\d\\.]+)[\"']?",
      ],
      depNameTemplate: "hashicorp/terraform",
      datasourceTemplate: "github-releases",
    },

    {
      customType: "regex",
      description: "Dockerfile ENV: TFLint",
      managerFilePatterns: ["/(^|/)Dockerfile$/"],
      matchStrings: [
        "ENV\\s+TFLINT_VERSION[=\\s][\"']?(?<currentValue>v?[\\d\\.]+)[\"']?",
      ],
      depNameTemplate: "terraform-linters/tflint",
      datasourceTemplate: "github-releases",
    },

    {
      customType: "regex",
      description: "Dockerfile ENV: Task",
      managerFilePatterns: ["/(^|/)Dockerfile$/"],
      matchStrings: [
        "ENV\\s+TASK_VERSION[=\\s][\"']?(?<currentValue>v?[\\d\\.]+)[\"']?",
      ],
      depNameTemplate: "go-task/task",
      datasourceTemplate: "github-releases",
    },
  ],

  packageRules: [
    {
      groupName: "Terraform Version",
      matchPackageNames: ["/terraform/"],
    },
    {
      groupName: "Go Ecosystem",
      matchPackageNames: ["/^go$/", "/golang/"],
    },
    {
      groupName: "TFLint Version",
      matchPackageNames: ["/tflint/"],
    },
    {
      groupName: "Task Version",
      matchPackageNames: ["/go-task/task/"],
    },
    {
      groupName: "Trivy Version",
      matchPackageNames: ["/trivy/"],
    },
  ],
}
